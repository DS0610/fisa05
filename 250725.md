# 250725 SQL, pymysql
---
### 정규화
- **중복 데이터**를 **줄이고**, **데이터 무결성**을 **높이기 위한** 데이터베이스 설계 원칙
- 데이터를 **효율적으로 저장**하고, **변경 시 오류 발생 가능성을 줄일 수 있음**

|정규형|목적|조치 내용|장점|
|---|---|---|---|
|1NF|원자값 유지(칸 하나만)|반복값 분리|처리 용이, 검색 정확도 향상|
|2NF|부분 종속 제거(중복되는 것 -> 다른표로)|정보 분리(ex. 수입사, 배급사, 제작사)|중복 제거(저장공간 확보), 무결성 유지|
|3NF|이행적 종속 제거|의미 단위 분리|테이블 의미 명확화|
|4NF|다치 종속 제거|N:M 관계 테이블 분리|관계 명확, 중복 최소화,  관련이 없는 조합 분리|
|5NF|조인 종속 제거(복합키 사용, 때로는 중복을 감수하더라도 서로 다른 필드의 데이터가 정확히 같이 있어야 의미가 있는 경우 정확한 관계를 다시 잘 연결)| 조인 복원 보장| 데이터 정확성, 구조 확장 용이|

### ERD
![ERD 다이어그램 예시](data:image/png;base64,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)
- 시스템의 엔티티들이 무엇이 있는지 어떤 관계가 있는지를 나타내는 다이어그램

##### Relationship Cardinality
![관계 표현 기호](https://paperdoll.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fd1a988f4-e527-4f37-84f2-5cf57ae3d75a%2F59c0ace6-0e7b-4eb2-bdbe-616e5b0d5080%2FUntitled.png?table=block&id=239efd73-3489-80f6-991c-f88825f0d0fa&spaceId=d1a988f4-e527-4f37-84f2-5cf57ae3d75a&width=760&userId=&cache=v2)

[ERD CLOUD](https://www.erdcloud.com/)

### pymysql로 DB연결
- pymysql : mysql을 python에서 사용할 수 있는 라이브러리
- mysql 코드 작성 순서
```
  1. 모듈 import
  2. pymysql.connect() 메소드로 MySQL에 연결
     - 호스트명, 포트, 로그인, 암호, 접속할 DB 등을 파라미터로 지정
  3. MySQL 접속이 성공하면, Connection 객체로부터 cursor() 메서드를 호출하여 Cursor 객체를 가져옴
  4. Cursor 객체의 execute() 메서드를 사용하여 SQL 문장을 DB 서버에 전송
  5. SQL 쿼리의 경우 Cursor 객체의 fetchall(), fetchone(), fetchmany() 등의 메서드를 사용하여 서버로부터 가져온 데이타를 코드에서 활용
  6. 삽입, 갱신, 삭제 등의 DML(Data Manipulation Language) 문장을 실행하는 경우, INSERT/UPDATE/DELETE 후 Connection 객체의 commit() 메서드를 사용하여 데이타를 확정
  7. Connection 객체의 close() 메서드를 사용하여 DB 연결을 닫음
```
```
pymysql.connect() 메소드를 사용하여 MySQL에 연결

호스트명, 포트, 로그인, 암호, 접속할 DB 등을 파라미터로 지정
주요 파라미터
host : 접속할 mysql server 주소
port : 접속할 mysql server 의 포트 번호
user : mysql ID
passwd : mysql ID의 암호
db : 접속할 데이터베이스
charset='utf8' : mysql에서 select하여 데이타를 가져올 때 한글이 깨질 수 있으므로 연결 설정에 넣어줌
```

- 데이터 삽입
```
데이터 삽입(INSERT)
Cursor Object 가져오기: cursor = db.cursor()
SQL 실행하기: cursor.execute(SQL)
실행 mysql 서버에 확정 반영하기: db.commit()
```

- 데이터 조회
```
데이터 조회(SELECT)
Cursor Object 가져오기: cursor = db.cursor()
SQL 실행하기: cursor.execute(SQL)
mysql 서버로부터 데이터 가져오기: fetch 메서드 사용
fetchall(): Fetch all the rows
fetchmany(size=None): Fetch several rows
fetchone(): Fetch the next row
```